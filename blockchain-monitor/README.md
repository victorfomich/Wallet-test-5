# DreamWallet Blockchain Monitor

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–ª–æ–∫—á–µ–π–Ω–æ–≤ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–µ–ø–æ–∑–∏—Ç–æ–≤ –Ω–∞ 5 —Å–µ—Ç—è—Ö.

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–µ—Ç–∏

- **TON** (The Open Network) - –Ω–∞—Ç–∏–≤–Ω—ã–µ TON
- **TRON** (TRC20) - TRX –∏ USDT TRC20
- **Solana** (SPL) - SOL –∏ USDT SPL
- **Ethereum** (ERC20) - ETH –∏ USDT ERC20
- **BNB Smart Chain** (BEP20) - BNB –∏ USDT BEP20

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cd blockchain-monitor
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
venv\Scripts\activate.bat  # Windows
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–∂–µ –ø—Ä–æ–ø–∏—Å–∞–Ω—ã –≤ `config.py` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏ Supabase.

## –ó–∞–ø—É—Å–∫

### –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```bash
python run.py --test
```

### –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
python run.py
```

### –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ (Linux/Mac)

```bash
nohup python run.py > monitor.log 2>&1 &
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –∞–¥—Ä–µ—Å–æ–≤**: –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –Ω–∞–±–æ—Ä—ã –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `address_sets`
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–∞–ª–∞–Ω—Å–æ–≤**: –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–ª–∞–Ω—Å—ã –≤—Å–µ—Ö –∞–¥—Ä–µ—Å–æ–≤
3. **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–µ–ø–æ–∑–∏—Ç–æ–≤**: –ï—Å–ª–∏ –±–∞–ª–∞–Ω—Å —É–≤–µ–ª–∏—á–∏–ª—Å—è, –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω–∏—Ü—É –∫–∞–∫ –¥–µ–ø–æ–∑–∏—Ç
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã**: 
   - –î–æ–±–∞–≤–ª—è–µ—Ç —Å—É–º–º—É –∫ –±–∞–ª–∞–Ω—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ `user_balances`
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ `wallet_transactions`

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –∏ —Ñ–∞–π–ª `monitor.log`
- –£—Ä–æ–≤–Ω–∏: INFO, WARNING, ERROR
- –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª–∏

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í `config.py` –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:

- `CHECK_INTERVAL` - –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30 —Å–µ–∫)
- `MIN_AMOUNT` - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è —É—á–µ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.000001)
- `BATCH_SIZE` - —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –∞–¥—Ä–µ—Å–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
blockchain-monitor/
‚îú‚îÄ‚îÄ config.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ database.py         # –†–∞–±–æ—Ç–∞ —Å Supabase
‚îú‚îÄ‚îÄ blockchain_clients.py  # –ö–ª–∏–µ–Ω—Ç—ã –¥–ª—è –±–ª–æ–∫—á–µ–π–Ω–æ–≤
‚îú‚îÄ‚îÄ monitor.py          # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îú‚îÄ‚îÄ run.py             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ requirements.txt   # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

### 1. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–µ–ø–æ–∑–∏—Ç–æ–≤

–ë–æ—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º:

```python
if current_balance > last_balance:
    deposit_amount = current_balance - last_balance
    # –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    await db.update_balance(user_id, currency, deposit_amount)
```

### 2. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–∞–ª—é—Ç—ã

- **–ù–∞—Ç–∏–≤–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã**: TON, TRX, SOL, ETH, BNB
- **USDT**: –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ç—è—Ö (TRC20, SPL, ERC20, BEP20)

### 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–û–±–Ω–æ–≤–ª—è—é—Ç—Å—è 2 —Ç–∞–±–ª–∏—Ü—ã:
- `user_balances` - –±–∞–ª–∞–Ω—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É)
- `wallet_transactions` - –∏—Å—Ç–æ—Ä–∏—è –¥–µ–ø–æ–∑–∏—Ç–æ–≤

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç—ã

### –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```bash
tail -f monitor.log
```

### –ü—Ä–∏–º–µ—Ä –ª–æ–≥–æ–≤

```
2024-01-15 14:30:15 - INFO - üîç –ù–∞—á–∏–Ω–∞–µ–º —Ü–∏–∫–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ 14:30:15
2024-01-15 14:30:16 - INFO - üí∞ –ù–æ–≤—ã–π –¥–µ–ø–æ–∑–∏—Ç: +1.5 USDT –Ω–∞ EQD4FPq-... (TRON)
2024-01-15 14:30:16 - INFO - üí∞ –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω: 123456789 +1.5 USDT (–±—ã–ª–æ: 5.2, —Å—Ç–∞–ª–æ: 6.7)
2024-01-15 14:30:16 - INFO - üìù –î–µ–ø–æ–∑–∏—Ç –∑–∞–ø–∏—Å–∞–Ω: 1.5 USDT –Ω–∞ TRON (tx: balance_check...)
2024-01-15 14:30:17 - INFO - ‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ 45/45 –ø—Ä–æ–≤–µ—Ä–æ–∫
2024-01-15 14:30:17 - INFO - ‚è±Ô∏è –¶–∏–∫–ª –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ 2.34 —Å–µ–∫—É–Ω–¥
```

## –û—Å—Ç–∞–Ω–æ–≤–∫–∞

- `Ctrl+C` –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- –ò–ª–∏ `kill PID` –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–ª—é—á–∏ Supabase –∞–∫—Ç—É–∞–ª—å–Ω—ã
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç: `python run.py --test`

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

1. –£–≤–µ–ª–∏—á—å—Ç–µ `CHECK_INTERVAL` –≤ config.py
2. –£–º–µ–Ω—å—à–∏—Ç–µ `BATCH_SIZE`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å RPC —Å–µ—Ä–≤–µ—Ä–æ–≤

### –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–µ–ø–æ–∑–∏—Ç—ã

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∞–¥—Ä–µ—Å–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –≤ –±–∞–∑–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `MIN_AMOUNT` –Ω–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏ API

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ë–æ—Ç —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç –±–∞–ª–∞–Ω—Å—ã, –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –Ω–µ –Ω—É–∂–Ω—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–µ RPC endpoint'—ã
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π Supabase
